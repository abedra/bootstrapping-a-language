<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Bootstrapping a Language</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="title" content="Bootstrapping a Language"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-05-08 07:47:41 CDT"/>
<meta name="author" content="Aaron Bedra"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>

<link rel="stylesheet" type="text/css" href="common.css" />
<link rel="stylesheet" type="text/css" href="screen.css" media="screen" />
<link rel="stylesheet" type="text/css" href="projection.css" media="projection" />
<link rel="stylesheet" type="text/css" href="presenter.css" media="presenter" />


</head>
<body>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Bootstrapping a Language</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 Bootstrapping A Language</a></li>
<li><a href="#sec-2">2 Once upon a time there was a REPL</a></li>
<li><a href="#sec-3">3 But that REPL didn't do much</a></li>
<li><a href="#sec-4">4 This is the true story&hellip; of several lines of code&hellip; picked to live in a REPL&hellip; to work together and have their lines executed&hellip; find out what happens when code stops being polite&hellip; and starts getting real&hellip;</a></li>
<li><a href="#sec-5">5 Everyone should try to write a language</a></li>
<li><a href="#sec-6">6 :slide:</a></li>
<li><a href="#sec-7">7 Peter Norvig</a></li>
<li><a href="#sec-8">8 The basics</a></li>
<li><a href="#sec-9">9 Let's start turning our REPL into a real language</a></li>
<li><a href="#sec-10">10 Turning the lisp source into tokens (Read)</a></li>
<li><a href="#sec-11">11 What it looks like</a></li>
<li><a href="#sec-12">12 Basic Evaluation</a></li>
<li><a href="#sec-13">13 Did we take a step back?</a></li>
<li><a href="#sec-14">14 We need a way to keep track of things so we can refer to them later</a></li>
<li><a href="#sec-15">15 Update eval to accept an env and repl to initialize an env</a></li>
<li><a href="#sec-16">16 Give it a try</a></li>
<li><a href="#sec-17">17 But our language still doesn't really know how to do anything&hellip;</a></li>
<li><a href="#sec-18">18 Define the basic primitives</a></li>
<li><a href="#sec-19">19 Now we're cooking</a></li>
<li><a href="#sec-20">20 Bootstrapping more basic functions</a></li>
<li><a href="#sec-21">21 Try it out</a></li>
<li><a href="#sec-22">22 We're almost there! Let's round things out</a></li>
<li><a href="#sec-23">23 Take in your new awesomeness</a></li>
<li><a href="#sec-24">24 We now have the basics of a language</a></li>
<li><a href="#sec-25">25 But we are missing a lot</a></li>
<li><a href="#sec-26">26 References</a></li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Bootstrapping A Language &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span>&nbsp;<span class="title">title</span></span></h2>
<div class="outline-text-2" id="text-1">

</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Once upon a time there was a REPL &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-2">




<pre class="src src-ruby"><span style="color: #b22222;">#</span><span style="color: #b22222;">!/usr/bin/env ruby</span>

<span style="color: #7f007f;">def</span> <span style="color: #0000ff;">repl</span>
  <span style="color: #7f007f;">while</span> <span style="color: #a0522d;">true</span>
    <span style="color: #8b2252;">"geeklisp&gt; "</span>.display
    p(gets)
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>

repl
</pre>

</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> But that REPL didn't do much &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-3">




<pre class="src src-sh">$ ./geeklisp
</pre>


<pre class="src src-scheme">geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">foo</span> 2)
(<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">foo</span> 2)
geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">bar</span> 5)
(<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">bar</span> 5)
geeklisp&gt; (+ foo bar)
(+ foo bar)
geeklisp&gt;
</pre>

</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> This is the true story&hellip; of several lines of code&hellip; picked to live in a REPL&hellip; to work together and have their lines executed&hellip; find out what happens when code stops being polite&hellip; and starts getting real&hellip; &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-4">

</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Everyone should try to write a language &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-5">

</div>

</div>

<div id="outline-container-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-6">

<p><img src="lisplogo.png"  alt="lisplogo.png" />
</p></div>

</div>

<div id="outline-container-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> Peter Norvig &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-7">

<p><img src="norvig.jpg"  alt="norvig.jpg" />
</p></div>

</div>

<div id="outline-container-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> The basics &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-8">

<table  border="2" cellspacing="0" cellpadding="6" rules="all" frame="border" align="center">
<caption></caption>
<colgroup><col class="left" /><col class="left" /><col class="left" />
</colgroup>
<thead>
<tr><th scope="col" class="left">Form</th><th scope="col" class="left">Syntax</th><th scope="col" class="left">Example</th></tr>
</thead>
<tbody>
<tr><td class="left">variable reference</td><td class="left"><code>var</code></td><td class="left"><code>x</code></td></tr>
<tr><td class="left">constant literal</td><td class="left"><code>number</code></td><td class="left"><code>12</code></td></tr>
<tr><td class="left">quoation</td><td class="left"><code>(quote exp)</code></td><td class="left"><code>(quote (1 2 3))</code></td></tr>
<tr><td class="left">conditional</td><td class="left"><code>(if test conseq alt)</code></td><td class="left"><code>(if (&lt; 10 20) #t #f)</code></td></tr>
<tr><td class="left">assignment</td><td class="left"><code>(set! var exp)</code></td><td class="left"><code>(set! x (* x x))</code></td></tr>
<tr><td class="left">definition</td><td class="left"><code>(define var exp)</code></td><td class="left"><code>(define r 3)</code></td></tr>
<tr><td class="left">procedure</td><td class="left"><code>(lambda (var...) exp)</code></td><td class="left"><code>(lambda (r) (* r r)))</code></td></tr>
<tr><td class="left">sequencing</td><td class="left"><code>(begin exp)</code></td><td class="left"><code>(begin (set! x 1) (* x 2))</code></td></tr>
<tr><td class="left">procedure call</td><td class="left"><code>(proc exp)</code></td><td class="left"><code>(square 12)</code></td></tr>
</tbody>
</table>

</div>

</div>

<div id="outline-container-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> Let's start turning our REPL into a real language &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-9">

</div>

</div>

<div id="outline-container-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> Turning the lisp source into tokens (Read) &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-10">




<pre class="src src-ruby"><span style="color: #7f007f;">def</span> <span style="color: #0000ff;">to_atom</span>(src)
  <span style="color: #7f007f;">return</span> <span style="color: #8b2252;">"["</span> <span style="color: #7f007f;">if</span> src ==<span style="color: #8b2252;">'('</span>
  <span style="color: #7f007f;">return</span> <span style="color: #8b2252;">"]"</span> <span style="color: #7f007f;">if</span> src ==<span style="color: #8b2252;">')'</span>
  <span style="color: #7f007f;">return</span> src <span style="color: #7f007f;">if</span> src =~ <span style="color: #8b2252;">/^-?\d+$/</span> || src =~ <span style="color: #8b2252;">/^-?\d*\.\d+$/</span>
  <span style="color: #8b2252;">':'</span> + src
<span style="color: #7f007f;">end</span>

<span style="color: #7f007f;">def</span> <span style="color: #0000ff;">read</span>(src)
  tokens = src.gsub(<span style="color: #8b2252;">'('</span>, <span style="color: #8b2252;">' ( '</span>).gsub(<span style="color: #8b2252;">')'</span>, <span style="color: #8b2252;">' ) '</span>).split
  <span style="color: #228b22;">Kernel</span>.eval(tokens.map{|s| to_atom(s)}.join(<span style="color: #8b2252;">' '</span>).gsub(<span style="color: #8b2252;">' ]'</span>,<span style="color: #8b2252;">']'</span>).gsub(<span style="color: #8b2252;">/([^\[]) /</span>,<span style="color: #8b2252;">'\1, '</span>))
<span style="color: #7f007f;">end</span>

<span style="color: #7f007f;">def</span> <span style="color: #0000ff;">repl</span>
  <span style="color: #7f007f;">while</span> <span style="color: #a0522d;">true</span>
    <span style="color: #8b2252;">"geeklisp&gt; "</span>.display
    p(read(gets))
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>
</pre>

</div>

</div>

<div id="outline-container-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> What it looks like &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-11">




<pre class="src src-scheme">$ ./geeklisp
geeklisp&gt; (+ 2 3)
[<span style="color: #483d8b;">:+</span>, 2, 3]
geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">sqr</span> (x) (* x x))
[<span style="color: #483d8b;">:define</span>, <span style="color: #483d8b;">:sqr</span>, [<span style="color: #483d8b;">:x</span>], [<span style="color: #483d8b;">:*</span>, <span style="color: #483d8b;">:x</span>, <span style="color: #483d8b;">:x</span>]]
geeklisp&gt; (sqr 2)
[<span style="color: #483d8b;">:sqr</span>, 2]
</pre>

</div>

</div>

<div id="outline-container-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> Basic Evaluation &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-12">




<pre class="src src-ruby"><span style="color: #7f007f;">def</span> <span style="color: #0000ff;">eval</span>(x)
  <span style="color: #7f007f;">return</span> x <span style="color: #7f007f;">if</span> !x.is_a? <span style="color: #228b22;">Array</span>
  <span style="color: #7f007f;">case</span> x[0]
    <span style="color: #7f007f;">when</span> <span style="color: #008b8b;">:quote</span> <span style="color: #7f007f;">then</span> x[1..-1]
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>

<span style="color: #7f007f;">def</span> <span style="color: #0000ff;">repl</span>
  <span style="color: #7f007f;">while</span> <span style="color: #a0522d;">true</span>
    <span style="color: #8b2252;">"geeklisp&gt; "</span>.display
    p(eval(read(gets)))
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>
</pre>

</div>

</div>

<div id="outline-container-13" class="outline-2">
<h2 id="sec-13"><span class="section-number-2">13</span> Did we take a step back? &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-13">




<pre class="src src-scheme">$ ./geeklisp
geeklisp&gt; (+ 2 3)
nil
geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">sqr</span> (<span style="color: #7f007f;">lambda</span> (x) (* x x)))
nil
geeklisp&gt; (sqr 4)
nil
geeklisp&gt; (quote (1 2 3 4))
[[1, 2, 3, 4]]
</pre>

</div>

</div>

<div id="outline-container-14" class="outline-2">
<h2 id="sec-14"><span class="section-number-2">14</span> We need a way to keep track of things so we can refer to them later &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-14">




<pre class="src src-ruby"><span style="color: #7f007f;">class</span> <span style="color: #228b22;">Env</span> &lt; <span style="color: #228b22;">Hash</span>
  <span style="color: #7f007f;">def</span> <span style="color: #0000ff;">initialize</span>(keys=[], vals=[], outer=<span style="color: #a0522d;">nil</span>)
    <span style="color: #a0522d;">@outer</span> = outer
    keys.zip(vals).each{|p| store(*p)}
  <span style="color: #7f007f;">end</span>

  <span style="color: #7f007f;">def</span> <span style="color: #0000ff;">[]</span> (name)
    <span style="color: #7f007f;">super</span>(name) || <span style="color: #a0522d;">@outer</span>[name]
  <span style="color: #7f007f;">end</span>

  <span style="color: #7f007f;">def</span> <span style="color: #0000ff;">set</span>(name, value)
    key?(name) ? store(name, value) : <span style="color: #a0522d;">@outer</span>.set(name, value)
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>
</pre>

</div>

</div>

<div id="outline-container-15" class="outline-2">
<h2 id="sec-15"><span class="section-number-2">15</span> Update eval to accept an env and repl to initialize an env &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-15">




<pre class="src src-ruby"><span style="color: #7f007f;">def</span> <span style="color: #0000ff;">eval</span>(x, env)
  <span style="color: #7f007f;">return</span> env[x] <span style="color: #7f007f;">if</span> x.is_a? <span style="color: #228b22;">Symbol</span>
  <span style="color: #7f007f;">return</span> x <span style="color: #7f007f;">if</span> !x.is_a? <span style="color: #228b22;">Array</span>
  <span style="color: #7f007f;">case</span> x[0]
  <span style="color: #7f007f;">when</span> <span style="color: #008b8b;">:quote</span> <span style="color: #7f007f;">then</span> x[1..-1]
  <span style="color: #7f007f;">when</span> <span style="color: #008b8b;">:define</span> <span style="color: #7f007f;">then</span> env[x[1]] = eval(x[2], env)
  <span style="color: #7f007f;">when</span> <span style="color: #008b8b;">:set!</span> <span style="color: #7f007f;">then</span> env.set(x[1], eval(x[2], env))
  <span style="color: #7f007f;">when</span> <span style="color: #008b8b;">:env</span> <span style="color: #7f007f;">then</span> env
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>

<span style="color: #7f007f;">def</span> <span style="color: #0000ff;">repl</span>
  env = <span style="color: #228b22;">Env</span>.new
  <span style="color: #7f007f;">while</span> <span style="color: #a0522d;">true</span>
    <span style="color: #8b2252;">"geeklisp&gt; "</span>.display
    p(eval(read(gets), env))
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>
</pre>

</div>

</div>

<div id="outline-container-16" class="outline-2">
<h2 id="sec-16"><span class="section-number-2">16</span> Give it a try &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-16">




<pre class="src src-scheme">./geeklisp
geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">foo</span> 5)
5
geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">sqr</span> (<span style="color: #7f007f;">lambda</span> (x) (* x x)))
nil
geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">bar</span> 27)
27
geeklisp&gt; foo
5
geeklisp&gt; bar
27
geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">baz</span> (quote (1 2 3)))
[[1, 2, 3]]
geeklisp&gt; (env)
{<span style="color: #483d8b;">:foo=&gt;5</span>, <span style="color: #483d8b;">:sqr=&gt;nil</span>, <span style="color: #483d8b;">:bar=&gt;27</span>, <span style="color: #483d8b;">:baz=&gt;</span>[[1, 2, 3]]}
</pre>

</div>

</div>

<div id="outline-container-17" class="outline-2">
<h2 id="sec-17"><span class="section-number-2">17</span> But our language still doesn't really know how to do anything&hellip; &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-17">




<pre class="src src-scheme">$ ./geeklisp
geeklisp&gt; (+ 2 3)
nil
geeklisp&gt; (car (1 2 3))
nil
geeklisp&gt; (cdr (1 2 3))
nil
geeklisp&gt; (+ (* 3 4) 5)
nil
</pre>

</div>

</div>

<div id="outline-container-18" class="outline-2">
<h2 id="sec-18"><span class="section-number-2">18</span> Define the basic primitives &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-18">




<pre class="src src-ruby"><span style="color: #7f007f;">def</span> <span style="color: #0000ff;">init</span>(env)
  [<span style="color: #008b8b;">:+</span>, <span style="color: #008b8b;">:-</span>, <span style="color: #008b8b;">:*</span>, <span style="color: #008b8b;">:/</span>, <span style="color: #008b8b;">:&gt;</span>, <span style="color: #008b8b;">:&lt;</span>, <span style="color: #008b8b;">:&gt;=</span>, <span style="color: #008b8b;">:&lt;=</span>, <span style="color: #008b8b;">:==</span>].each <span style="color: #7f007f;">do</span> |op|
    env[op] = lambda{|a, b| a.send(op, b)}
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>

<span style="color: #7f007f;">def</span> <span style="color: #0000ff;">repl</span>
  env = init(<span style="color: #228b22;">Env</span>.new)
  <span style="color: #7f007f;">while</span> <span style="color: #a0522d;">true</span>
    <span style="color: #8b2252;">"geeklisp&gt; "</span>.display
    p(eval(read(gets), env))
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>

<span style="color: #7f007f;">def</span> <span style="color: #0000ff;">eval</span>(x, env)
  ...
  <span style="color: #7f007f;">else</span>
    exps = x.map{|exp| eval(exp, env)}
    exps[0].call(*exps[1..-1])
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>
</pre>

</div>

</div>

<div id="outline-container-19" class="outline-2">
<h2 id="sec-19"><span class="section-number-2">19</span> Now we're cooking &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-19">




<pre class="src src-scheme">$ ./geeklisp
geeklisp&gt; (* 2 3)
6
geeklisp&gt; (&gt; 2 3)
false
geeklisp&gt; (&lt; 2 3)
true
geeklisp&gt; (/ 4 12)
0
geeklisp&gt; (/ 12 4)
3
geeklisp&gt; (- 5 6)
-1
geeklisp&gt; (== 5 5)
true
</pre>

</div>

</div>

<div id="outline-container-20" class="outline-2">
<h2 id="sec-20"><span class="section-number-2">20</span> Bootstrapping more basic functions &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-20">




<pre class="src src-ruby"><span style="color: #7f007f;">def</span> <span style="color: #0000ff;">init</span>(env)
  [<span style="color: #008b8b;">:+</span>, <span style="color: #008b8b;">:-</span>, <span style="color: #008b8b;">:*</span>, <span style="color: #008b8b;">:/</span>, <span style="color: #008b8b;">:&gt;</span>, <span style="color: #008b8b;">:&lt;</span>, <span style="color: #008b8b;">:&gt;=</span>, <span style="color: #008b8b;">:&lt;=</span>, <span style="color: #008b8b;">:==</span>].each <span style="color: #7f007f;">do</span> |op|
    env[op] = lambda{|a, b| a.send(op, b)}
  <span style="color: #7f007f;">end</span>

  env.update({<span style="color: #008b8b;">:length</span> =&gt; lambda{|x| x.length},
              <span style="color: #008b8b;">:cons</span> =&gt; lambda{|x,y| [x] + y},
              <span style="color: #008b8b;">:car</span> =&gt; lambda{|x| x[0]},
              <span style="color: #008b8b;">:cdr</span> =&gt; lambda{|x| x[1..-1]},
              <span style="color: #008b8b;">:append</span> =&gt; lambda{|x,y| x + y},
              <span style="color: #008b8b;">:list</span> =&gt; lambda{|*xs| xs},
              <span style="color: #008b8b;">:list?</span> =&gt; lambda{|x| x.is_a? <span style="color: #228b22;">Array</span>},
              <span style="color: #008b8b;">:symbol?</span> =&gt; lambda{|x| x.is_a? <span style="color: #228b22;">Symbol</span>},
              <span style="color: #008b8b;">:not</span> =&gt; lambda{|x| !x},
              <span style="color: #008b8b;">:display</span> =&gt; lambda{|x| p x}})
<span style="color: #7f007f;">end</span>
</pre>

</div>

</div>

<div id="outline-container-21" class="outline-2">
<h2 id="sec-21"><span class="section-number-2">21</span> Try it out &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-21">




<pre class="src src-scheme">(<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">foo</span> (list 1 2 3))
[1, 2, 3]
geeklisp&gt; (car foo)
1
geeklisp&gt; (cdr foo)
[2, 3]
geeklisp&gt; (cons 4 foo)
[4, 1, 2, 3]
geeklisp&gt; (list? foo)
true
geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">bar</span> 5)
5
geeklisp&gt; (list? 5)
false
</pre>

</div>

</div>

<div id="outline-container-22" class="outline-2">
<h2 id="sec-22"><span class="section-number-2">22</span> We're almost there! Let's round things out &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-22">




<pre class="src src-ruby"><span style="color: #7f007f;">def</span> <span style="color: #0000ff;">eval</span>(x, env)
  ...
  <span style="color: #7f007f;">when</span> <span style="color: #008b8b;">:if</span>
    _, test, conseq, alt = x
    eval(eval(test, env) ? conseq : alt, env)
  <span style="color: #7f007f;">when</span> <span style="color: #008b8b;">:lambda</span>
    _, vars, exp = x
    <span style="color: #228b22;">Proc</span>.new{|*args| eval(exp, <span style="color: #228b22;">Env</span>.new(vars, args, env))}
  <span style="color: #7f007f;">when</span> <span style="color: #008b8b;">:begin</span>
    x[1..-1].reduce([<span style="color: #a0522d;">nil</span>, env]){|val_env, exp| [eval(exp, val_env[1]), val_env[1]]}[0]
  <span style="color: #7f007f;">else</span>
    exps = x.map{|exp| eval(exp, env)}
    exps[0].call(*exps[1..-1])
  <span style="color: #7f007f;">end</span>
<span style="color: #7f007f;">end</span>
</pre>

</div>

</div>

<div id="outline-container-23" class="outline-2">
<h2 id="sec-23"><span class="section-number-2">23</span> Take in your new awesomeness &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-23">




<pre class="src src-scheme">$ ./geeklisp
geeklisp&gt; (<span style="color: #7f007f;">if</span> (&lt; 3 5) 10 20)
10
geeklisp&gt; (<span style="color: #7f007f;">if</span> (&gt; 3 5) 10 20)
20
geeklisp&gt; (<span style="color: #7f007f;">define</span> <span style="color: #0000ff;">square</span> (<span style="color: #7f007f;">lambda</span> (x) (* x x)))
#&lt;Proc:0x00000001001b7aa0@./geeklisp:41&gt;
geeklisp&gt; (square 12)
144
geeklisp&gt; (<span style="color: #7f007f;">begin</span> (set! x 1) (set! x (+ x 1)) (* x 2))
4
</pre>

</div>

</div>

<div id="outline-container-24" class="outline-2">
<h2 id="sec-24"><span class="section-number-2">24</span> We now have the basics of a language &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-24">

</div>

</div>

<div id="outline-container-25" class="outline-2">
<h2 id="sec-25"><span class="section-number-2">25</span> But we are missing a lot &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-25">

<ul>
<li>No error handling
</li>
<li>Not a complete implementation of the scheme spec
</li>
<li>No ability to load a file and run it
</li>
<li>No core after the bootstrap (stdlib)
</li>
<li>No callcc/tail recursion
</li>
<li>No save-world
</li>
</ul>

</div>

</div>

<div id="outline-container-26" class="outline-2">
<h2 id="sec-26"><span class="section-number-2">26</span> References &nbsp;&nbsp;&nbsp;<span class="tag"><span class="slide">slide</span></span></h2>
<div class="outline-text-2" id="text-26">

<ul>
<li>(How to Write a (Lisp) Interpreter (in Python)) <a href="http://norvig.com/lispy.html">norvig.com/lispy.html</a>
</li>
<li>SICP <a href="http://mitpress.mit.edu/sicp/">mitpress.mit.edu/sicp/</a>
</li>
<li>Scheme Specification <a href="http://www.schemers.org/Documents/Standards/R5RS/">www.schemers.org/Documents/Standards/R5RS/</a>
</li>
</ul>






<script type="text/javascript" src="org-html-slideshow.js"></script>

</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2012-05-08 07:47:41 CDT</p>
<p class="author">Author: Aaron Bedra</p>
<p class="creator">Org version 7.8.03 with Emacs version 24</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
